<!doctype html><html class="theme-next mist use-motion" lang="zh-Hans"><head><meta name="generator" content="Hexo 3.9.0"><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><script src="//cdn.bootcss.com/pace/1.0.2/pace.min.js"></script><link href="//cdn.bootcss.com/pace/1.0.2/themes/pink/pace-theme-flash.css" rel="stylesheet"><style>.pace .pace-progress{background:#1e92fb;height:3px}.pace .pace-progress-inner{box-shadow:0 0 10px #1e92fb,0 0 5px #1e92fb}.pace .pace-activity{border-top-color:#1e92fb;border-left-color:#1e92fb}</style><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css"><link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css"><link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css"><link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css"><meta name="keywords" content="Fabric,"><link rel="alternate" href="/atom.xml" title="DongSheng's Blog" type="application/atom+xml"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.0"><meta name="description" content="Fabric简介　　Fabric是一个Python库，可以通过SSH在多个host上批量执行任务。你可以编写任务脚本，然后通过Fabric在本地就可以使用SSH在大量远程服务器上自动运行。这些功能非常适合应用的自动化部署，或者执行系统管理任务。官网 中文站点Fabric常用环境变量fabric的环境变量有很多，存放在一个字典中，fabric.state.env，而它包含在fabric.api中，为"><meta name="keywords" content="Fabric"><meta property="og:type" content="article"><meta property="og:title" content="Fabric"><meta property="og:url" content="https://mds1455975151.github.io/archives/6a4f7595.html"><meta property="og:site_name" content="DongSheng&#39;s Blog"><meta property="og:description" content="Fabric简介　　Fabric是一个Python库，可以通过SSH在多个host上批量执行任务。你可以编写任务脚本，然后通过Fabric在本地就可以使用SSH在大量远程服务器上自动运行。这些功能非常适合应用的自动化部署，或者执行系统管理任务。官网 中文站点Fabric常用环境变量fabric的环境变量有很多，存放在一个字典中，fabric.state.env，而它包含在fabric.api中，为"><meta property="og:locale" content="zh-Hans"><meta property="og:image" content="https://mds1455975151.github.io/archives/6a4f7595/01.png"><meta property="og:image" content="https://mds1455975151.github.io/archives/f7ea3e07/zhifubao.jpg"><meta property="og:updated_time" content="2020-04-03T07:09:13.780Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="Fabric"><meta name="twitter:description" content="Fabric简介　　Fabric是一个Python库，可以通过SSH在多个host上批量执行任务。你可以编写任务脚本，然后通过Fabric在本地就可以使用SSH在大量远程服务器上自动运行。这些功能非常适合应用的自动化部署，或者执行系统管理任务。官网 中文站点Fabric常用环境变量fabric的环境变量有很多，存放在一个字典中，fabric.state.env，而它包含在fabric.api中，为"><meta name="twitter:image" content="https://mds1455975151.github.io/archives/6a4f7595/01.png"><script type="text/javascript" id="hexo.configurations">var NexT=window.NexT||{},CONFIG={root:"/",scheme:"Mist",sidebar:{position:"right",display:"post",offset:12,offset_float:0,b2t:!1,scrollpercent:!1},fancybox:!0,motion:!0,duoshuo:{userId:"0",author:"博主"},algolia:{applicationID:"",apiKey:"",indexName:"",hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}}}</script><link rel="canonical" href="https://mds1455975151.github.io/archives/6a4f7595.html"><title>Fabric | DongSheng's Blog</title><script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script>(adsbygoogle=window.adsbygoogle||[]).push({google_ad_client:"ca-pub-8670258387043414",enable_page_level_ads:!0})</script></head><body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans"><div style="display:none"><script src="//s95.cnzz.com/z_stat.php?id=1271299436&web_id=1271299436" language="JavaScript"></script></div><div class="container one-collumn sidebar-position-right page-post-detail"><div class="headband"></div><a href="https://github.com/mds1455975151/mds1455975151.github.io"><img style="position:absolute;top:0;right:0;border:0" src="https://camo.githubusercontent.com/38ef81f8aca64bb9a64448d0d70f1308ef5341ab/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f6461726b626c75655f3132313632312e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png"></a><header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-wrapper"><div class="site-meta"><div class="custom-logo-site-title"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span> <span class="site-title">DongSheng's Blog</span> <span class="logo-line-after"><i></i></span></a></div><p class="site-subtitle">记录点滴，不断突破</p></div><div class="site-nav-toggle"><button><span class="btn-bar"></span> <span class="btn-bar"></span> <span class="btn-bar"></span></button></div></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i><br>首页</a></li><li class="menu-item menu-item-categories"><a href="/categories" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i><br>分类</a></li><li class="menu-item menu-item-about"><a href="/about" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i><br>关于</a></li><li class="menu-item menu-item-archives"><a href="/archives" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i><br>归档</a></li><li class="menu-item menu-item-tags"><a href="/tags" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i><br>标签</a></li><li class="menu-item menu-item-sitemap"><a href="/sitemap.xml" rel="section"><i class="menu-item-icon fa fa-fw fa-sitemap"></i><br>站点地图</a></li><li class="menu-item menu-item-ask-for-links"><a href="/ask-for-links" rel="section"><i class="menu-item-icon fa fa-fw fa-coffee"></i><br>申请友链</a></li><li class="menu-item menu-item-hot"><a href="/hot" rel="section"><i class="menu-item-icon fa fa-fw fa-photo"></i><br>热度</a></li><li class="menu-item menu-item-search"><a href="javascript:;" class="popup-trigger"><i class="menu-item-icon fa fa-search fa-fw"></i><br>搜索</a></li></ul><div class="site-search"><div class="popup local-search-popup"><div class="local-search-header clearfix"><span class="search-icon"><i class="fa fa-search"></i> </span><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span><div class="local-search-input-wrapper"><input autocapitalize="off" autocomplete="off" autocorrect="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input"></div></div><div id="local-search-result"></div></div></div></nav><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?c07b7d36eacd98b4b4dd92fc182723f4";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script></div></header><main id="main" class="main"><div class="main-inner"><div class="content-wrap"><div id="content" class="content"><div id="posts" class="posts-expand"><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><link itemprop="mainEntityOfPage" href="https://mds1455975151.github.io/archives/6a4f7595.html"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="DongSheng"><meta itemprop="description" content><meta itemprop="image" content="/images/avatar.jpg"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="DongSheng's Blog"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">Fabric</h1><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-12-10T17:28:08+08:00">2017-12-10 </time></span><span class="post-category"><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-folder-o"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Linux运维/" itemprop="url" rel="index"><span itemprop="name">Linux运维</span> </a></span></span><span class="post-comments-count"><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-comment-o"></i> </span><a href="/archives/6a4f7595.html#comments" itemprop="discussionUrl"><span class="post-comments-count disqus-comment-count" data-disqus-identifier="archives/6a4f7595.html" itemprop="commentCount"></span> </a></span><span id="/archives/6a4f7595.html" class="leancloud_visitors" data-flag-title="Fabric"><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-eye"></i> </span><span class="post-meta-item-text">阅读次数 </span><span class="leancloud-visitors-count"></span> </span><span class="post-time">&nbsp; | &nbsp; <span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i> </span><span class="post-meta-item-text">字数统计:</span> <span class="post-count">3,422(字)</span> </span><span class="post-time">&nbsp; | &nbsp; <span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i> </span><span class="post-meta-item-text">阅读时长:</span> <span class="post-count">17(分)</span></span></div></header><div class="post-body" itemprop="articleBody"><h1 id="Fabric简介"><a href="#Fabric简介" class="headerlink" title="Fabric简介"></a>Fabric简介</h1><p>　　Fabric是一个Python库，可以通过SSH在多个host上批量执行任务。你可以编写任务脚本，然后通过Fabric在本地就可以使用SSH在大量远程服务器上自动运行。这些功能非常适合应用的自动化部署，或者执行系统管理任务。<br><a href="http://www.fabfile.org/" target="_blank" rel="noopener">官网</a> <a href="http://fabric-chs.readthedocs.io/zh_CN/chs/" target="_blank" rel="noopener">中文站点</a></p><h1 id="Fabric常用环境变量"><a href="#Fabric常用环境变量" class="headerlink" title="Fabric常用环境变量"></a>Fabric常用环境变量</h1><p>fabric的环境变量有很多，存放在一个字典中，fabric.state.env，而它包含在fabric.api中，为了方便，我们一般使用env来指代环境变量。env环境变量可以控制很多fabric的行为，一般通过env.xxx可以进行设置。<br>fabric默认使用本地用户通过ssh进行连接远程机器，不过你可以通过env.user变量进行覆盖。当你进行ssh连接时，fabric会让你交互的让你输入远程机器密码，如果你设置了env.password变量，则就不需要交互的输入密码。</p><h2 id="常用的环境变量"><a href="#常用的环境变量" class="headerlink" title="常用的环境变量"></a>常用的环境变量</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> fabric.api</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">for</span> i <span class="keyword">in</span> fabric.api.env:</span><br><span class="line"><span class="meta">... </span>    print(i)</span><br><span class="line">...</span><br><span class="line">disable_known_hosts     <span class="comment"># 默认是false，如果是true，则会跳过用户知道的hosts文件</span></span><br><span class="line">effective_roles</span><br><span class="line">tasks</span><br><span class="line">linewise</span><br><span class="line">show</span><br><span class="line">password　　　　　　　　　　<span class="comment"># 定义密码</span></span><br><span class="line">key_filename</span><br><span class="line">abort_on_prompts</span><br><span class="line">skip_unknown_tasks</span><br><span class="line">reject_unknown_hosts</span><br><span class="line">skip_bad_hosts                  <span class="comment"># 默认false，为ture时，会导致fab跳过无法连接的主机</span></span><br><span class="line">use_ssh_config</span><br><span class="line">roledefs　　　　　　　　　　<span class="comment"># 定义角色分组，例如：区分DB主机与web主机</span></span><br><span class="line">gateway　　　　　　　　　　<span class="comment"># 定义网关（中转，堡垒机）IP</span></span><br><span class="line">gss_auth</span><br><span class="line">keepalive</span><br><span class="line">eagerly_disconnect</span><br><span class="line">rcfile</span><br><span class="line">path_behavior</span><br><span class="line">hide</span><br><span class="line">sudo_prefix</span><br><span class="line">lcwd</span><br><span class="line">no_agent</span><br><span class="line">forward_agent</span><br><span class="line">remote_interrupt</span><br><span class="line">port　　　　　　　　　　<span class="comment"># 定义目标主机的端口</span></span><br><span class="line">shell</span><br><span class="line">version</span><br><span class="line">use_exceptions_for</span><br><span class="line">connection_attempts</span><br><span class="line">hosts　　　　　　<span class="comment"># 定义目标主机</span></span><br><span class="line">gss_deleg</span><br><span class="line">cwd</span><br><span class="line">abort_exception</span><br><span class="line">real_fabfile</span><br><span class="line">passwords　　　　　　<span class="comment"># 与password功能一致，区别在于不同主机不同密码的应用场景</span></span><br><span class="line">sudo_password</span><br><span class="line">host_string</span><br><span class="line">shell_env</span><br><span class="line">always_use_pty</span><br><span class="line">colorize_errors</span><br><span class="line">exclude_hosts   <span class="comment"># 排除指定主机</span></span><br><span class="line">all_hosts</span><br><span class="line">sudo_prompt</span><br><span class="line">again_prompt</span><br><span class="line">echo_stdin</span><br><span class="line">user　　　　　　　　<span class="comment"># 定义ssh使用哪个用户登录远程主机</span></span><br><span class="line">gss_kex</span><br><span class="line">command_timeout</span><br><span class="line">path</span><br><span class="line">local_user</span><br><span class="line">combine_stderr</span><br><span class="line">command_prefixes</span><br><span class="line">dedupe_hosts</span><br><span class="line">warn_only</span><br><span class="line">no_keys</span><br><span class="line">sudo_passwords</span><br><span class="line">roles</span><br><span class="line">fabfile</span><br><span class="line">use_shell</span><br><span class="line">host</span><br><span class="line">pool_size</span><br><span class="line">system_known_hosts</span><br><span class="line">prompts</span><br><span class="line">output_prefix</span><br><span class="line">command</span><br><span class="line">timeout　　　　　　　　<span class="comment"># 默认10 网络连接的超时时间</span></span><br><span class="line">default_port</span><br><span class="line">ssh_config_path</span><br><span class="line">parallel</span><br><span class="line">sudo_user</span><br><span class="line">ok_ret_codes</span><br></pre></td></tr></table></figure><h1 id="Fabric执行模式"><a href="#Fabric执行模式" class="headerlink" title="Fabric执行模式"></a>Fabric执行模式</h1><p>执行策略：fabric默认是单一的，串行的执行函数，虽然有一个paralle模式可供你选择。默认的行为遵循以下优先级规则：<br>1、一个task列表被创建，通过命令行传递给fab<br>2、针对每一个task，都有一个主机列表通过变量设置<br>3、task列表按顺序执行每个task在主机列表中的主机上执行一遍<br>4、如果主机列表为空，则默认在本地执行，也是执行一次</p><h1 id="Fabric常用API"><a href="#Fabric常用API" class="headerlink" title="Fabric常用API"></a>Fabric常用API</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">[root@bogon fabric]<span class="comment"># python</span></span><br><span class="line">Python <span class="number">2.6</span><span class="number">.6</span> (r266:<span class="number">84292</span>, Jul <span class="number">23</span> <span class="number">2015</span>, <span class="number">14</span>:<span class="number">41</span>:<span class="number">34</span>)</span><br><span class="line">[GCC <span class="number">4.4</span><span class="number">.7</span> <span class="number">20120313</span> (Red Hat <span class="number">4.4</span><span class="number">.7</span><span class="number">-11</span>)] on linux2</span><br><span class="line">Type <span class="string">"help"</span>, <span class="string">"copyright"</span>, <span class="string">"credits"</span> <span class="keyword">or</span> <span class="string">"license"</span> <span class="keyword">for</span> more information.</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> tab</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> fabric.api</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">for</span> i <span class="keyword">in</span> dir(fabric.api):</span><br><span class="line"><span class="meta">... </span>    print(i)</span><br><span class="line">...</span><br><span class="line">__builtins__</span><br><span class="line">__doc__</span><br><span class="line">__file__</span><br><span class="line">__name__</span><br><span class="line">__package__</span><br><span class="line">abort</span><br><span class="line">cd                 <span class="comment"># 切换远程目录</span></span><br><span class="line">env</span><br><span class="line">execute</span><br><span class="line">fastprint</span><br><span class="line">get              <span class="comment"># 从远程主机下载文件到本地</span></span><br><span class="line">hide</span><br><span class="line">hosts</span><br><span class="line">lcd              <span class="comment"># 切换本地目录</span></span><br><span class="line">local           <span class="comment"># 执行本地命令</span></span><br><span class="line">open_shell</span><br><span class="line">output</span><br><span class="line">parallel</span><br><span class="line">path</span><br><span class="line">prefix</span><br><span class="line">prompt          <span class="comment"># 获取用户输入信息</span></span><br><span class="line">put               <span class="comment"># 上传本地文件到远程主机</span></span><br><span class="line">puts</span><br><span class="line">quiet</span><br><span class="line">reboot</span><br><span class="line">remote_tunnel</span><br><span class="line">require</span><br><span class="line">roles</span><br><span class="line">run                    <span class="comment"># 执行远程命令</span></span><br><span class="line">runs_once          <span class="comment"># 函数修饰符 标识的函数只会执行一次，不收多台主机影响</span></span><br><span class="line">serial</span><br><span class="line">settings</span><br><span class="line">shell_env</span><br><span class="line">show</span><br><span class="line">sudo              <span class="comment"># sudo方式执行远程命令</span></span><br><span class="line">task              <span class="comment"># 函数修饰符，标识的函数为fab可以调用</span></span><br><span class="line">warn</span><br><span class="line">warn_only</span><br><span class="line">with_settings</span><br></pre></td></tr></table></figure><p>API应用场景案例<br>案例1：同时查看本地及远程主机信息<br>案例2：动态获取远程目录列表<br>案例3：网关模式文件的上传与下载</p><h1 id="Fabric安装及使用"><a href="#Fabric安装及使用" class="headerlink" title="Fabric安装及使用"></a>Fabric安装及使用</h1><h2 id="Fabric安装"><a href="#Fabric安装" class="headerlink" title="Fabric安装"></a>Fabric安装</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">pip install fabric</span><br><span class="line">easy_install fabric</span><br><span class="line">or</span><br><span class="line">源码安装</span><br></pre></td></tr></table></figure><p>fab命令默认被安装到Python的目录下，需要创建软链接</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">[root@saltstack ~]<span class="comment"># find / -type f -name "fab"</span></span><br><span class="line">/usr/local/python2<span class="number">.7</span><span class="number">.10</span>/bin/fab</span><br><span class="line">[root@saltstack ~]<span class="comment"># ln -s /usr/local/python2.7.10/bin/fab /usr/bin/fab</span></span><br><span class="line">[root@saltstack fabric]<span class="comment"># fab -h</span></span><br><span class="line">Usage: fab [options] &lt;command&gt;[:arg1,arg2=val2,host=foo,hosts=<span class="string">'h1;h2'</span>,...] ...</span><br><span class="line"></span><br><span class="line">Options:</span><br><span class="line">  -h, --help            show this help message <span class="keyword">and</span> exit</span><br><span class="line">  -d NAME, --display=NAME <span class="keyword">print</span> detailed info about command NAME</span><br><span class="line">  -F FORMAT, --list-format=FORMAT formats --list, choices: short, normal, nested</span><br><span class="line">  -I, --initial-password-prompt  Force password prompt up-front</span><br><span class="line">  --initial-sudo-password-prompt  Force sudo password prompt up-front</span><br><span class="line">  -l, --list            <span class="keyword">print</span> list of possible commands <span class="keyword">and</span> exit                   <span class="comment"># 显示一个脚本中可用的task（命令）</span></span><br><span class="line">  --set=KEY=VALUE,...   comma separated KEY=VALUE pairs to set Fab env vars</span><br><span class="line">  --shortlist           alias <span class="keyword">for</span> -F short --list</span><br><span class="line">  -V, --version         show program<span class="string">'s version number and exit</span></span><br><span class="line"><span class="string">  -a, --no_agent        don'</span>t use the running SSH agent</span><br><span class="line">  -A, --forward-agent   forward local agent to remote end</span><br><span class="line">  --abort-on-prompts    abort instead of prompting (<span class="keyword">for</span> password, host, etc)</span><br><span class="line">  -c PATH, --config=PATH specify location of config file to use</span><br><span class="line">  --colorize-errors     Color error output</span><br><span class="line">  -D, --disable-known-hosts  do <span class="keyword">not</span> load user known_hosts file</span><br><span class="line">  -e, --eagerly-disconnect disconnect <span class="keyword">from</span> hosts <span class="keyword">as</span> soon <span class="keyword">as</span> possible</span><br><span class="line">  -f PATH, --fabfile=PATH  python module file to <span class="keyword">import</span>, e.g. <span class="string">'../other.py'</span>   <span class="comment"># 指定入口文件，fab默认入口文件是：fabfile/fabfile.py</span></span><br><span class="line">  -g HOST, --gateway=HOST  gateway host to connect through　　　　　　<span class="comment"># 指定网关（中转）设备，比如堡垒机环境，填写堡垒机IP即可</span></span><br><span class="line">  --gss-auth            Use GSS-API authentication</span><br><span class="line">  --gss-deleg           Delegate GSS-API client credentials <span class="keyword">or</span> <span class="keyword">not</span></span><br><span class="line">  --gss-kex             Perform GSS-API Key Exchange <span class="keyword">and</span> user authentication</span><br><span class="line">  --hide=LEVELS         comma-separated list of output levels to hide</span><br><span class="line">  -H HOSTS, --hosts=HOSTS   comma-separated list of hosts to operate on      <span class="comment"># 指定host，支持多host逗号分开</span></span><br><span class="line">  -i PATH               path to SSH private key file. May be repeated.</span><br><span class="line">  -k, --no-keys         don<span class="string">'t load private key files from ~/.ssh/</span></span><br><span class="line"><span class="string">  --keepalive=N         enables a keepalive every N seconds</span></span><br><span class="line"><span class="string">  --linewise            print line-by-line instead of byte-by-byte</span></span><br><span class="line"><span class="string">  -n M, --connection-attempts=M make M attempts to connect before giving up</span></span><br><span class="line"><span class="string">  --no-pty              do not use pseudo-terminal in run/sudo</span></span><br><span class="line"><span class="string">  -p PASSWORD, --password=PASSWORD  password for use with authentication and/or sudo</span></span><br><span class="line"><span class="string">  -P, --parallel        default to parallel execution method    # 以异步并行方式运行多主机任务，默认是串行</span></span><br><span class="line"><span class="string">  --port=PORT           SSH connection port</span></span><br><span class="line"><span class="string">  -r, --reject-unknown-hosts   reject unknown hosts</span></span><br><span class="line"><span class="string">  --sudo-password=SUDO_PASSWORD  password for use with sudo only</span></span><br><span class="line"><span class="string">  --system-known-hosts=SYSTEM_KNOWN_HOSTS  load system known_hosts file before reading user known_hosts</span></span><br><span class="line"><span class="string">  -R ROLES, --roles=ROLES comma-separated list of roles to operate on    # 指定role，支持多个，即以角色名区分不同业务组设备</span></span><br><span class="line"><span class="string">  -s SHELL, --shell=SHELL  specify a new shell, defaults to '</span>/bin/bash -l -c<span class="string">'</span></span><br><span class="line"><span class="string">  --show=LEVELS         comma-separated list of output levels to show</span></span><br><span class="line"><span class="string">  --skip-bad-hosts      skip over hosts that can'</span>t be reached</span><br><span class="line">  --skip-unknown-tasks  skip over unknown tasks</span><br><span class="line">  --ssh-config-path=PATH   Path to SSH config file</span><br><span class="line">  -t N, --timeout=N     set connection timeout to N seconds　　　　<span class="comment"># 设置设备连接超时时间（秒）</span></span><br><span class="line">  -T N, --command-timeout=N  set remote command timeout to N seconds   <span class="comment"># 设置远程主机命令执行超时时间（秒）</span></span><br><span class="line">  -u USER, --user=USER  username to use when connecting to remote hosts　　</span><br><span class="line">  -w, --warn-only       warn, instead of abort, when commands fail     <span class="comment"># warn_only，默认是碰到异常直接abort退出，该设置为发出告警，但不退出</span></span><br><span class="line">  -x HOSTS, --exclude-hosts=HOSTS  comma-separated list of hosts to exclude</span><br><span class="line">  -z INT, --pool-size=INT  number of concurrent processes to use <span class="keyword">in</span> parallel mode</span><br></pre></td></tr></table></figure><h1 id="Fabric应用案例"><a href="#Fabric应用案例" class="headerlink" title="Fabric应用案例"></a>Fabric应用案例</h1><h2 id="案例1：本地执行一组操作"><a href="#案例1：本地执行一组操作" class="headerlink" title="案例1：本地执行一组操作"></a>案例1：本地执行一组操作</h2><p>直接用命令行的形式执行远程命令</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">[root@bogon fabric]<span class="comment"># fab -p 'strong' -H 192.168.80.128 -- 'uname -m'</span></span><br><span class="line">[192.168.80.128] Executing task <span class="string">'&lt;remainder&gt;'</span></span><br><span class="line">[192.168.80.128] run: uname -m</span><br><span class="line">[192.168.80.128] out: i686</span><br><span class="line">[192.168.80.128] out:</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Done.</span><br><span class="line">Disconnecting from 192.168.80.128... <span class="keyword">done</span>.</span><br><span class="line"></span><br><span class="line">[root@saltstack fabric]<span class="comment"># cat fabric_8.py</span></span><br><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># coding:utf-8</span></span><br><span class="line"></span><br><span class="line">from fabric.api import <span class="built_in">local</span></span><br><span class="line"></span><br><span class="line">def prepare_deploy():</span><br><span class="line">    <span class="built_in">local</span>(<span class="string">"./manage.py test my_app"</span>)</span><br><span class="line">    <span class="built_in">local</span>(<span class="string">"git add -p &amp;&amp; git commit"</span>)</span><br><span class="line">    <span class="built_in">local</span>(<span class="string">"git push"</span>)</span><br><span class="line"></span><br><span class="line">[root@saltstack fabric]<span class="comment"># fab -f fabric_8.py prepare_deploy     # 报错是因为测试环境不足所致</span></span><br><span class="line">[localhost] <span class="built_in">local</span>: ./manage.py <span class="built_in">test</span> my_app</span><br><span class="line">/bin/sh: ./manage.py: 没有那个文件或目录</span><br><span class="line"></span><br><span class="line">Fatal error: <span class="built_in">local</span>() encountered an error (<span class="built_in">return</span> code 127) <span class="keyword">while</span> executing <span class="string">'./manage.py test my_app'</span></span><br><span class="line"></span><br><span class="line">Aborting.</span><br></pre></td></tr></table></figure><h2 id="案例2：远程查看服务器类型"><a href="#案例2：远程查看服务器类型" class="headerlink" title="案例2：远程查看服务器类型"></a>案例2：远程查看服务器类型</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">[root@saltstack fabric]<span class="comment"># cat fabric_1.py</span></span><br><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># coding:utf-8</span></span><br><span class="line"></span><br><span class="line">from fabric.api import run</span><br><span class="line"></span><br><span class="line">def host_type():</span><br><span class="line">    run(<span class="string">'uname -s'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 注：fabfile.py为fab默认识别的文件名，如果不是该文件名需要使用-f参数说明要执行的文件名</span></span><br><span class="line">[root@saltstack fabric]<span class="comment"># fab -H localhost -f fabric_1.py host_type</span></span><br><span class="line">[localhost] Executing task <span class="string">'host_type'</span></span><br><span class="line">[localhost] run: uname -s</span><br><span class="line">[localhost] out: Linux</span><br><span class="line">[localhost] out:</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Done.</span><br><span class="line">Disconnecting from localhost... <span class="keyword">done</span>.</span><br></pre></td></tr></table></figure><h2 id="案例3：远程传递参数（本地执行原理一致）"><a href="#案例3：远程传递参数（本地执行原理一致）" class="headerlink" title="案例3：远程传递参数（本地执行原理一致）"></a>案例3：远程传递参数（本地执行原理一致）</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">[root@saltstack fabric]<span class="comment"># cat fabric_2.py</span></span><br><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># coding:utf-8</span></span><br><span class="line"></span><br><span class="line">from fabric.api import run</span><br><span class="line"></span><br><span class="line">def host_type(name):</span><br><span class="line">    run(<span class="string">'uname -s'</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"Hello %s !!!"</span> % name)</span><br><span class="line"></span><br><span class="line">[root@saltstack fabric]<span class="comment"># fab -H localhost -f fabric_2.py host_type:name=mads</span></span><br><span class="line">[localhost] Executing task <span class="string">'host_type'</span></span><br><span class="line">[localhost] run: uname -s</span><br><span class="line">[localhost] out: Linux</span><br><span class="line">[localhost] out:</span><br><span class="line"></span><br><span class="line">Hello mads !!!</span><br><span class="line"></span><br><span class="line">Done.</span><br><span class="line">Disconnecting from localhost... <span class="keyword">done</span>.</span><br></pre></td></tr></table></figure><h2 id="案例4：多台服务器批量执行相同的操作"><a href="#案例4：多台服务器批量执行相同的操作" class="headerlink" title="案例4：多台服务器批量执行相同的操作"></a>案例4：多台服务器批量执行相同的操作</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">[root@saltstack fabric]<span class="comment"># cat fabric_3.py</span></span><br><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># coding:utf-8</span></span><br><span class="line"></span><br><span class="line">from fabric.api import run,<span class="built_in">cd</span>,env,hosts</span><br><span class="line">env.hosts=[<span class="string">'192.168.20.140:22'</span>,<span class="string">'172.16.1.150:22'</span>]   <span class="comment"># env.hosts=['user@ip:port',] ssh要用到的参数格式</span></span><br><span class="line">env.password=<span class="string">'strong'</span></span><br><span class="line"></span><br><span class="line">def host_type():</span><br><span class="line">    with <span class="built_in">cd</span>(<span class="string">'/tmp/'</span>):</span><br><span class="line">        run(<span class="string">'du -ksh *'</span>)</span><br><span class="line"></span><br><span class="line">[root@saltstack fabric]<span class="comment"># fab -f fabric_3.py host_type</span></span><br><span class="line">[192.168.20.140:22] Executing task <span class="string">'host_type'</span></span><br><span class="line">[192.168.20.140:22] run: du -ksh *</span><br><span class="line">[192.168.20.140:22] out: 36K    hsperfdata_rundeck</span><br><span class="line">[192.168.20.140:22] out: 8.0K   pip-3wB4vO-unpack</span><br><span class="line">[192.168.20.140:22] out: 4.0K   rundeck</span><br><span class="line">[192.168.20.140:22] out: 4.0K   yum_save_tx-2016-07-30-20-49HgACou.yumtx</span><br><span class="line">[192.168.20.140:22] out:</span><br><span class="line"></span><br><span class="line">[172.16.1.150:22] Executing task <span class="string">'host_type'</span></span><br><span class="line">[172.16.1.150:22] run: du -ksh *</span><br><span class="line">[172.16.1.150:22] out: 4.0K     uname.txt</span><br><span class="line">[172.16.1.150:22] out:</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Done.</span><br><span class="line">Disconnecting from 172.16.1.150... <span class="keyword">done</span>.</span><br><span class="line">Disconnecting from 192.168.20.140... <span class="keyword">done</span>.</span><br></pre></td></tr></table></figure><h2 id="案例5：多台服务器混合，需要在不同服务器进行不同操作时"><a href="#案例5：多台服务器混合，需要在不同服务器进行不同操作时" class="headerlink" title="案例5：多台服务器混合，需要在不同服务器进行不同操作时"></a>案例5：多台服务器混合，需要在不同服务器进行不同操作时</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">[root@saltstack fabric]<span class="comment"># cat fabric_4.py</span></span><br><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># coding:utf-8</span></span><br><span class="line"></span><br><span class="line">from fabric.api import env,roles,run,execute</span><br><span class="line"></span><br><span class="line">env.roledefs = &#123;</span><br><span class="line"><span class="string">'server1'</span>: [<span class="string">'root@172.16.1.140:22'</span>,],</span><br><span class="line"><span class="string">'server2'</span>: [<span class="string">'root@172.16.1.150:22'</span>, ]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">env.password = <span class="string">'strong'</span></span><br><span class="line">@roles(<span class="string">'server1'</span>)</span><br><span class="line">def task1():</span><br><span class="line">    run(<span class="string">'ls /home/ -l | wc -l'</span>)</span><br><span class="line"></span><br><span class="line">@roles(<span class="string">'server2'</span>)</span><br><span class="line">def task2():</span><br><span class="line">    run(<span class="string">'du -sh /home'</span>)</span><br><span class="line"></span><br><span class="line">def <span class="built_in">test</span>():               <span class="comment"># 调节主机组和主机组执行操作的顺序</span></span><br><span class="line">    execute(task2)</span><br><span class="line">    execute(task1)</span><br><span class="line"></span><br><span class="line">[root@saltstack fabric]<span class="comment"># fab -f fabric_4.py test</span></span><br><span class="line">[root@172.16.1.150:22] Executing task <span class="string">'task2'</span></span><br><span class="line">[root@172.16.1.150:22] run: du -sh /home</span><br><span class="line">[root@172.16.1.150:22] out: 4.0K        /home</span><br><span class="line">[root@172.16.1.150:22] out:</span><br><span class="line"></span><br><span class="line">[root@172.16.1.140:22] Executing task <span class="string">'task1'</span></span><br><span class="line">[root@172.16.1.140:22] run: ls /home/ -l | wc -l</span><br><span class="line">[root@172.16.1.140:22] out: 3</span><br><span class="line">[root@172.16.1.140:22] out:</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Done.</span><br><span class="line">Disconnecting from 172.16.1.150... <span class="keyword">done</span>.</span><br><span class="line">Disconnecting from 172.16.1.140... <span class="keyword">done</span>.</span><br></pre></td></tr></table></figure><h1 id="Fabric扩展"><a href="#Fabric扩展" class="headerlink" title="Fabric扩展"></a>Fabric扩展</h1><h2 id="扩展1：打印颜色"><a href="#扩展1：打印颜色" class="headerlink" title="扩展1：打印颜色"></a>扩展1：打印颜色</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">[root@saltstack fabric]<span class="comment"># cat fabric_5.py</span></span><br><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># coding:utf-8</span></span><br><span class="line"></span><br><span class="line">from fabric.colors import *</span><br><span class="line"></span><br><span class="line">def show():</span><br><span class="line">    <span class="built_in">print</span> green(<span class="string">'success'</span>)</span><br><span class="line">    <span class="built_in">print</span> red(<span class="string">'fail'</span>)</span><br><span class="line">    <span class="built_in">print</span> yellow(<span class="string">'yellow'</span>)</span><br><span class="line"></span><br><span class="line">[root@saltstack fabric]<span class="comment"># fab -f fabric_5.py show</span></span><br><span class="line">success</span><br><span class="line">fail</span><br><span class="line">yellow</span><br><span class="line"></span><br><span class="line">Done.</span><br></pre></td></tr></table></figure><p>效果图：<br><img src="/archives/6a4f7595/01.png" alt></p><h2 id="扩展2：错误及异常"><a href="#扩展2：错误及异常" class="headerlink" title="扩展2：错误及异常"></a>扩展2：错误及异常</h2><p>默认，一组命令，上一个命令执行失败后，不会接着往下执行，失败后也可以进行不一样的处理，详解文档<br>默认情况</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">[root@saltstack fabric]<span class="comment"># cat fabric_6.py</span></span><br><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># coding:utf-8</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#from fabric.api import run</span></span><br><span class="line">from fabric.api import <span class="built_in">local</span></span><br><span class="line"></span><br><span class="line">def host_type():</span><br><span class="line">    <span class="built_in">local</span>(<span class="string">'uname -s'</span>)</span><br><span class="line">    <span class="built_in">local</span>(<span class="string">'tt'</span>)</span><br><span class="line">    <span class="built_in">local</span>(<span class="string">'hostname'</span>)</span><br><span class="line"></span><br><span class="line">[root@saltstack fabric]<span class="comment"># fab -H localhost -f fabric_6.py host_type</span></span><br><span class="line">[localhost] Executing task <span class="string">'host_type'</span></span><br><span class="line">[localhost] <span class="built_in">local</span>: uname -s</span><br><span class="line">Linux</span><br><span class="line">[localhost] <span class="built_in">local</span>: tt</span><br><span class="line">/bin/sh: tt: <span class="built_in">command</span> not found</span><br><span class="line"></span><br><span class="line">Fatal error: <span class="built_in">local</span>() encountered an error (<span class="built_in">return</span> code 127) <span class="keyword">while</span> executing <span class="string">'tt'</span></span><br><span class="line"></span><br><span class="line">Aborting.</span><br><span class="line"><span class="comment"># 注：由于tt执行报错，后面的hostname命令没有被执行</span></span><br><span class="line"></span><br><span class="line">[root@saltstack fabric]<span class="comment"># cat fabric_7.py</span></span><br><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># coding:utf-8</span></span><br><span class="line"></span><br><span class="line">from __future__ import with_statement</span><br><span class="line">from fabric.api import <span class="built_in">local</span>, settings, abort</span><br><span class="line">from fabric.colors import *</span><br><span class="line">from fabric.contrib.console import confirm</span><br><span class="line"></span><br><span class="line">def host_type():</span><br><span class="line">    <span class="built_in">local</span>(<span class="string">'uname -s'</span>)</span><br><span class="line">    with settings(warn_only=True):</span><br><span class="line">        result = <span class="built_in">local</span>(<span class="string">'tt'</span>, capture=True)</span><br><span class="line">    <span class="keyword">if</span> result.failed and not confirm(red(<span class="string">"tt cmd failed. Continue anyway?"</span>)):</span><br><span class="line">        abort(<span class="string">"Aborting at user request."</span>)</span><br><span class="line">    <span class="built_in">local</span>(<span class="string">'hostname'</span>)</span><br><span class="line">[root@saltstack fabric]<span class="comment"># fab -H localhost -f fabric_7.py host_type</span></span><br><span class="line">[localhost] Executing task <span class="string">'host_type'</span></span><br><span class="line">[localhost] <span class="built_in">local</span>: uname -s</span><br><span class="line">Linux</span><br><span class="line">[localhost] <span class="built_in">local</span>: tt</span><br><span class="line"></span><br><span class="line">Warning: <span class="built_in">local</span>() encountered an error (<span class="built_in">return</span> code 127) <span class="keyword">while</span> executing <span class="string">'tt'</span></span><br><span class="line"></span><br><span class="line">tt cmd failed. Continue anyway? [Y/n] y        <span class="comment"># 判断上一步执行有无异常，异常给予提示，确认是否继续</span></span><br><span class="line">[localhost] <span class="built_in">local</span>: hostname</span><br><span class="line">saltstack</span><br><span class="line"></span><br><span class="line">Done.</span><br></pre></td></tr></table></figure><h2 id="扩展3：密码管理"><a href="#扩展3：密码管理" class="headerlink" title="扩展3：密码管理"></a>扩展3：密码管理</h2><p>1）Fabric既支持ssh公钥认证也支持管理密码的机制<br>2）Fabric的密码管理机制提供了两层密码。如果你的server有相同的密码，可以在env.password中设置默认的密码；如果server密码不同，还可以在env.passwords中设置(host,password）对，为每个server设置单独的ssh密码。</p><h1 id="Fabric小结"><a href="#Fabric小结" class="headerlink" title="Fabric小结"></a>Fabric小结</h1><p>　　使用Fabric，你可以管理一系列host的SSH连接（包括主机名，用户，密码），定义一系列的任务函数，然后灵活的指定在哪些host上执行哪些任务。这非常使用于需要管理大量host的场景，比如运维，私有云管理，应用自动化部署等。<br>　　本文只是一篇入门文档，远没有体现出Fabric的强大。实际上，Fabric还包括大量的功能，比如Role的定义，远程交互及异常处理，并发执行，文件操作等，并且不仅仅局限于命令行方式，可以在你的应用中调用Fabric。<br>　　希望本文能够引起你对Fabric的兴趣，并在你的实际应用中解决问题。</p><p>======================================================<br>希望各位朋友支持一下</p><ul><li>领取我的<a href="https://promotion.aliyun.com/ntms/act/ambassador/sharetouser.html?userCode=xpdsz87p&utm_source=xpdsz87p" target="_blank" rel="noopener">阿里云幸运券</a>,谢谢.</li><li>使用<a href="https://cloud.tencent.com/redirect.php?redirect=1005&cps_key=5a162632de40024cd01aabff4d3f1370" target="_blank" rel="noopener">腾讯云资源</a></li><li><a href="https://www.linode.com/?r=82f5a02930ac529c4176aff09c1513cf9e7b4418" target="_blank" rel="noopener">Linode VPS</a></li><li><a href="https://bandwagonhost.com/aff.php?aff=38634" target="_blank" rel="noopener">搬瓦工VPS</a></li><li>阿里云1888元云产品通用代金券<a href="https://promotion.aliyun.com/ntms/yunparter/invite.html?userCode=xpdsz87p" target="_blank" rel="noopener">点我</a></li><li>阿里云最新活动<a href="https://promotion.aliyun.com/ntms/act/vmpt/aliyun-group/home.html?userCode=xpdsz87p" target="_blank" rel="noopener">全民云计算升级-拼团上云更优惠</a> <img src="/archives/f7ea3e07/zhifubao.jpg" width="50%"></li></ul><p><strong>本文作者</strong>：dongsheng<br><strong>本文地址</strong>： <a href="https://mds1455975151.github.io/archives/6a4f7595.html">https://mds1455975151.github.io/archives/6a4f7595.html</a><br><strong>版权声明</strong>：转载请注明出处！</p></div><div></div><div><div style="padding:10px 0;margin:20px auto;width:90%;text-align:center"><div>坚持技术分享，您的支持将鼓励我继续创作！</div><button id="rewardButton" disable="enable" onclick='var qr=document.getElementById("QR");"none"===qr.style.display?qr.style.display="block":qr.style.display="none"'><span>赏</span></button><div id="QR" style="display:none"><div id="wechat" style="display:inline-block"><img id="wechat_qr" src="/images/wechatpay.jpg" alt="DongSheng WeChat Pay"><p>微信打赏</p></div><div id="alipay" style="display:inline-block"><img id="alipay_qr" src="/images/alipay.jpg" alt="DongSheng Alipay"><p>支付宝打赏</p></div></div></div></div><footer class="post-footer"><div class="post-tags"><a href="/tags/Fabric/" rel="tag"><i class="fa fa-tag"></i> Fabric</a></div><div class="post-nav"><div class="post-nav-next post-nav-item"><a href="/archives/9357d8a6.html" rel="next" title="clustershell"><i class="fa fa-chevron-left"></i> clustershell</a></div><span class="post-nav-divider"></span><div class="post-nav-prev post-nav-item"><a href="/archives/10d12fcf.html" rel="prev" title="搭建本地pypi源方法">搭建本地pypi源方法 <i class="fa fa-chevron-right"></i></a></div></div></footer></article><div class="post-spread"><div class="addthis_inline_share_toolbox"><script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=2151375" async></script></div></div></div></div><div class="jiathis_style"><a class="jiathis_button_tsina"></a> <a class="jiathis_button_tqq"></a> <a class="jiathis_button_weixin"></a> <a class="jiathis_button_cqq"></a> <a class="jiathis_button_douban"></a> <a class="jiathis_button_renren"></a> <a class="jiathis_button_qzone"></a> <a class="jiathis_button_kaixin001"></a> <a class="jiathis_button_copy"></a> <a href="http://www.jiathis.com/share" class="jiathis jiathis_txt jiathis_separator jtico jtico_jiathis" target="_blank"></a> <a class="jiathis_counter_style"></a></div><script type="text/javascript">var jiathis_config={hideMore:!1}</script><script type="text/javascript" src="http://v3.jiathis.com/code/jia.js" charset="utf-8"></script><div class="ds-share flat" data-thread-key="archives/6a4f7595.html" data-title="Fabric" data-content data-url="https://mds1455975151.github.io/archives/6a4f7595.html"><div class="ds-share-inline"><div class="ds-share-icons-more"></div></div></div><div class="comments" id="comments"><div id="disqus_thread"><noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div></div><div style="display:none"><script src="//s95.cnzz.com/z_stat.php?id=1271299436&web_id=1271299436" language="JavaScript"></script></div></div><div class="sidebar-toggle"><div class="sidebar-toggle-line-wrap"><span class="sidebar-toggle-line sidebar-toggle-line-first"></span> <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span> <span class="sidebar-toggle-line sidebar-toggle-line-last"></span></div></div><aside id="sidebar" class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">文章目录</li><li class="sidebar-nav-overview" data-target="site-overview">站点概览</li></ul><section class="site-overview sidebar-panel"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="site-author-image" itemprop="image" src="/images/avatar.jpg" alt="DongSheng"><p class="site-author-name" itemprop="name">DongSheng</p><p class="site-description motion-element" itemprop="description">技术、产品、管理、思维格局</p></div><nav class="site-state motion-element"><div class="site-state-item site-state-posts"><a href="/archives"><span class="site-state-item-count">217</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"><a href="/categories"><span class="site-state-item-count">28</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"><a href="/tags"><span class="site-state-item-count">343</span> <span class="site-state-item-name">标签</span></a></div></nav><div class="feed-link motion-element"><a href="/atom.xml" rel="alternate"><i class="fa fa-rss"></i> RSS</a></div><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="https://github.com/sjkcdpc" target="_blank" title="GitHub"><i class="fa fa-fw fa-github"></i> GitHub </a></span><span class="links-of-author-item"><a href="https://www.zhihu.com/people/nba-14" target="_blank" title="ZhiHu"><i class="fa fa-fw fa-globe"></i> ZhiHu </a></span><span class="links-of-author-item"><a href="https://www.youtube.com/channel/UCWeGuhnmgIU4U6Hn0FX6tPA" target="_blank" title="Youtube"><i class="fa fa-fw fa-youtube"></i> Youtube </a></span><span class="links-of-author-item"><a href="mailto:madscdpc@gmail.com" target="_blank" title="Email"><i class="fa fa-fw fa-envelope"></i> Email</a></span></div><div class="links-of-blogroll motion-element links-of-blogroll-block"><div class="links-of-blogroll-title"><i class="fa fa-fw fa-globe"></i> 友情链接</div><ul class="links-of-blogroll-list"><li class="links-of-blogroll-item"><a href="https://www.bobcoder.cc/" title="Bob`S BLOG" target="_blank">Bob`S BLOG</a></li><li class="links-of-blogroll-item"><a href="https://xq773939719.github.io/" title="冰水鉴心" target="_blank">冰水鉴心</a></li><li class="links-of-blogroll-item"><a href="https://www.caiyifan.cn/" title="客舍青青" target="_blank">客舍青青</a></li><li class="links-of-blogroll-item"><a href="https://easyai.tech" title="easyAI-人工智能知识库" target="_blank">easyAI-人工智能知识库</a></li></ul></div></section><section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active"><div class="post-toc"><div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Fabric简介"><span class="nav-number">1.</span> <span class="nav-text">Fabric简介</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Fabric常用环境变量"><span class="nav-number">2.</span> <span class="nav-text">Fabric常用环境变量</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#常用的环境变量"><span class="nav-number">2.1.</span> <span class="nav-text">常用的环境变量</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Fabric执行模式"><span class="nav-number">3.</span> <span class="nav-text">Fabric执行模式</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Fabric常用API"><span class="nav-number">4.</span> <span class="nav-text">Fabric常用API</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Fabric安装及使用"><span class="nav-number">5.</span> <span class="nav-text">Fabric安装及使用</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Fabric安装"><span class="nav-number">5.1.</span> <span class="nav-text">Fabric安装</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Fabric应用案例"><span class="nav-number">6.</span> <span class="nav-text">Fabric应用案例</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#案例1：本地执行一组操作"><span class="nav-number">6.1.</span> <span class="nav-text">案例1：本地执行一组操作</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#案例2：远程查看服务器类型"><span class="nav-number">6.2.</span> <span class="nav-text">案例2：远程查看服务器类型</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#案例3：远程传递参数（本地执行原理一致）"><span class="nav-number">6.3.</span> <span class="nav-text">案例3：远程传递参数（本地执行原理一致）</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#案例4：多台服务器批量执行相同的操作"><span class="nav-number">6.4.</span> <span class="nav-text">案例4：多台服务器批量执行相同的操作</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#案例5：多台服务器混合，需要在不同服务器进行不同操作时"><span class="nav-number">6.5.</span> <span class="nav-text">案例5：多台服务器混合，需要在不同服务器进行不同操作时</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Fabric扩展"><span class="nav-number">7.</span> <span class="nav-text">Fabric扩展</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#扩展1：打印颜色"><span class="nav-number">7.1.</span> <span class="nav-text">扩展1：打印颜色</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#扩展2：错误及异常"><span class="nav-number">7.2.</span> <span class="nav-text">扩展2：错误及异常</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#扩展3：密码管理"><span class="nav-number">7.3.</span> <span class="nav-text">扩展3：密码管理</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Fabric小结"><span class="nav-number">8.</span> <span class="nav-text">Fabric小结</span></a></li></ol></div></div></section></div></aside></div></main><footer id="footer" class="footer"><div class="footer-inner"><script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div class="copyright">&copy; 2017 - <span itemprop="copyrightYear">2023</span> <span class="with-love"><i class="fa fa-heart"></i> </span><span class="author" itemprop="copyrightHolder">DongSheng</span></div><div class="powered-by"><a class="theme-link" rel="external nofollow" href="https://tongji.baidu.com/web/24822762/overview/index?siteId=11512948">百度分析</a></div><div class="powered-by">由 <a class="theme-link" rel="external nofollow" href="https://hexo.io">Hexo</a> 强力驱动</div><div class="theme-info">主题 - <a class="theme-link" rel="external nofollow" href="https://github.com/iissnan/hexo-theme-next">NexT.Mist </a><span id="busuanzi_container_site_pv" class="theme-info">&nbsp;&nbsp;|&nbsp;&nbsp;本站总访问量<span id="busuanzi_value_site_pv"></span>次 </span><span id="busuanzi_container_site_uv" class="theme-info">&nbsp;&nbsp;|&nbsp;&nbsp;本站访客数<span id="busuanzi_value_site_uv"></span>人次</span></div></div></footer><div class="back-to-top"><i class="fa fa-arrow-up"></i></div></div><script type="text/javascript">"[object Function]"!==Object.prototype.toString.call(window.Promise)&&(window.Promise=null)</script><script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script><script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script><script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script><script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script><script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script><script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script><script type="text/javascript" src="/lib/canvas-nest/canvas-nest.min.js"></script><script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script><script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script><script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.0"></script><script type="text/javascript" src="/js/src/post-details.js?v=5.1.0"></script><script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script><script type="text/javascript">var disqus_shortname="mdslq",disqus_identifier="archives/6a4f7595.html",disqus_title="Fabric";function run_disqus_script(s){var i=document.createElement("script");i.type="text/javascript",i.async=!0,i.src="//"+disqus_shortname+".disqus.com/"+s,(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(i)}run_disqus_script("count.js");var disqus_config=function(){this.page.url=disqus_url,this.page.identifier=disqus_identifier,this.page.title=disqus_title};run_disqus_script("embed.js")</script><script type="text/javascript">var isfetched=!1,search_path="search.xml";0==search_path.length&&(search_path="search.xml");var path="/"+search_path;function proceedsearch(){$("body").append('<div class="local-search-pop-overlay">').css("overflow","hidden"),$(".popup").toggle()}var searchFunc=function(e,r,s){"use strict";$.ajax({url:e,dataType:"xml",async:!0,success:function(e){isfetched=!0,$(".popup").detach().appendTo(".header-inner");var t=$("entry",e).map(function(){return{title:$("title",this).text(),content:$("content",this).text(),url:$("url",this).text()}}).get(),a=document.getElementById(r),c=document.getElementById(s);a.addEventListener("input",function(){var u=0,d='<ul class="search-result-list">',f=this.value.trim().toLowerCase().split(/[\s\-]+/);c.innerHTML="",1<this.value.trim().length&&t.forEach(function(e){var a,c,t,r,s,n,o=!1,i=e.title.trim().toLowerCase(),l=e.content.trim().replace(/<[^>]+>/g,"").toLowerCase(),p=decodeURIComponent(e.url),h=-1;""!=i&&f.forEach(function(e,t){a=i.indexOf(e),c=l.indexOf(e),(0<=a||0<=c)&&(o=!0,0==t&&(h=c))}),o&&(u+=1,d+="<li><a href='"+p+"' class='search-result-title'>"+i+"</a>",t=e.content.trim().replace(/<[^>]+>/g,""),0<=h&&(s=h+80,(r=h-20)<0&&(r=0),0==r&&(s=50),s>t.length&&(s=t.length),n=t.substring(r,s),f.forEach(function(e){var t=new RegExp(e,"gi");n=n.replace(t,'<b class="search-keyword">'+e+"</b>")}),d+='<p class="search-result">'+n+"...</p>"),d+="</li>")}),d+="</ul>",0==u&&(d='<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'),""==f&&(d='<div id="no-result"><i class="fa fa-search fa-5x" /></div>'),c.innerHTML=d}),proceedsearch()}})};$(".popup-trigger").click(function(e){e.stopPropagation(),0==isfetched?searchFunc(path,"local-search-input","local-search-result"):proceedsearch()}),$(".popup-btn-close").click(function(e){$(".popup").hide(),$(".local-search-pop-overlay").remove(),$("body").css("overflow","")}),$(".popup").click(function(e){e.stopPropagation()})</script><script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.1.js"></script><script>AV.initialize("zkRHIN9YTUmv5PenxYHomhod-gzGzoHsz","gGNCtLGo1MP3aLhMysPSI4lJ")</script><script>function showTime(e){var t=new AV.Query(e),c=[],u=$(".leancloud_visitors");u.each(function(){c.push($(this).attr("id").trim())}),t.containedIn("url",c),t.find().done(function(e){var t=".leancloud-visitors-count";if(0!==e.length){for(var n=0;n<e.length;n++){var o=e[n],i=o.get("url"),s=o.get("time"),r=document.getElementById(i);$(r).find(t).text(s)}for(n=0;n<c.length;n++){var i=c[n],r=document.getElementById(i),l=$(r).find(t);""==l.text()&&l.text(0)}}else u.find(t).text(0)}).fail(function(e,t){console.log("Error: "+t.code+" "+t.message)})}function addCount(i){var e=$(".leancloud_visitors"),s=e.attr("id").trim(),r=e.attr("data-flag-title").trim(),t=new AV.Query(i);t.equalTo("url",s),t.find({success:function(e){var t,n,o;0<e.length?((t=e[0]).fetchWhenSave(!0),t.increment("time"),t.save(null,{success:function(e){$(document.getElementById(s)).find(".leancloud-visitors-count").text(e.get("time"))},error:function(e,t){console.log("Failed to save Visitor num, with error message: "+t.message)}})):(n=new i,(o=new AV.ACL).setPublicReadAccess(!0),o.setPublicWriteAccess(!0),n.setACL(o),n.set("title",r),n.set("url",s),n.set("time",1),n.save(null,{success:function(e){$(document.getElementById(s)).find(".leancloud-visitors-count").text(e.get("time"))},error:function(e,t){console.log("Failed to create")}}))},error:function(e){console.log("Error:"+e.code+" "+e.message)}})}$(function(){var e=AV.Object.extend("Counter");1==$(".leancloud_visitors").length?addCount(e):1<$(".post-title-link").length&&showTime(e)})</script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({log:!1,pluginJsPath:"lib/",pluginModelPath:"assets/",pluginRootPath:"live2dw/",tagMode:!1})</script></body></html>